import{p as Re,a as Ee,_ as Ge,b as Qe,c as Je}from"./content-3263433b.js";import{d as _e,n as se,a4 as ve,o as i,c as h,V as o,a8 as Ke,a2 as n,a as r,F as le,a5 as oe,a3 as V,_,e as y,M as f,Q as d,O as m,s as E,r as c,E as Xe,j as Ye,w as Ze}from"./@vue-7e1ab0af.js";import{u as pe}from"./vuex-f1ee712f.js";import{u as ea,b as aa}from"./vue-router-edf90322.js";import{c as ta,b as sa}from"./formatTime-4210fcd1.js";import{c as la}from"./copy-to-clipboard-4ef7d3eb.js";import{i as me,j as oa,l as na,m as ua,o as ia,w as ca,x as re,y as ra,z as _a,D as va,G as pa}from"./@vicons-b98681e0.js";import{j as O,o as de,M as fe,e as ge,O as he,a as ke,L as ma,R as da,F as fa,k as ga,f as ha,g as ka,H as wa,G as ya}from"./naive-ui-df120204.js";import{_ as ba}from"./post-item.vue_vue_type_style_index_0_lang-870ff78f.js";import{_ as Pa}from"./post-skeleton-1c687629.js";import{W as $a,_ as Ta}from"./whisper-add-friend-04a17bf1.js";import{C as xa,B as N,D as za,E as Ca,F as Ma,G as qa,_ as Oa}from"./index-8c4266fc.js";import{W as Sa}from"./v3-infinite-loading-0611cb6c.js";import"./paopao-video-player-66a1a537.js";import"./moment-2ab8298d.js";import"./@babel-725317a4.js";import"./toggle-selection-93f4ad84.js";import"./seemly-76b7b838.js";import"./vueuc-2fc92f18.js";import"./evtd-b614532e.js";import"./@css-render-16be7445.js";import"./vooks-e23078ea.js";import"./vdirs-b0483831.js";import"./@juggle-41516555.js";import"./css-render-6a5c5852.js";import"./@emotion-8a8e73f6.js";import"./lodash-es-8412e618.js";import"./treemate-25c27bff.js";import"./async-validator-dee29e8b.js";import"./date-fns-975a2d8f.js";import"./axios-4a70c6fc.js";/* empty css               */const Ia={class:"post-item"},Fa={class:"nickname-wrap"},La={class:"username-wrap"},Ua={class:"timestamp-mobile"},Da={class:"item-header-extra"},Wa=["innerHTML"],Ba={class:"opt-item"},ja={class:"opt-item"},Aa=_e({__name:"mobile-tweet-item",props:{post:{}},setup(ne){const I=ne,k=ea(),$=pe(),p=a=>()=>E(O,null,{default:()=>E(a)}),w=se(()=>[{label:"复制链接",key:"copyTweetLink",icon:p(ia)}]),t=async a=>{switch(a){case"copyTweetLink":la(`${window.location.origin}/#/post?id=${s.value.id}`),window.$message.success("链接已复制到剪贴板");break}},s=se(()=>{let a=Object.assign({texts:[],imgs:[],videos:[],links:[],attachments:[],charge_attachments:[]},I.post);return a.contents.map(u=>{(+u.type==1||+u.type==2)&&a.texts.push(u),+u.type==3&&a.imgs.push(u),+u.type==4&&a.videos.push(u),+u.type==6&&a.links.push(u),+u.type==7&&a.attachments.push(u),+u.type==8&&a.charge_attachments.push(u)}),a}),C=a=>{k.push({name:"post",query:{id:a}})},F=(a,u)=>{if(a.target.dataset.detail){const b=a.target.dataset.detail.split(":");if(b.length===2){$.commit("refresh"),b[0]==="tag"?k.push({name:"home",query:{q:b[1],t:"tag"}}):k.push({name:"user",query:{s:b[1]}});return}}C(u)};return(a,u)=>{const b=de,L=ve("router-link"),M=fe,U=ge,P=he,l=Ee,T=Ge,D=Qe,W=Je,B=ke,j=ma;return i(),h("div",Ia,[o(j,{"content-indented":""},Ke({avatar:n(()=>[o(b,{round:"",size:30,src:s.value.user.avatar},null,8,["src"])]),header:n(()=>[r("span",Fa,[o(L,{onClick:u[0]||(u[0]=V(()=>{},["stop"])),class:"username-link",to:{name:"me",query:{s:s.value.user.username}}},{default:n(()=>[y(f(s.value.user.nickname),1)]),_:1},8,["to"])]),r("span",La," @"+f(s.value.user.username),1),s.value.is_top?(i(),d(M,{key:0,class:"top-tag",type:"warning",size:"small",round:""},{default:n(()=>[y(" 置顶 ")]),_:1})):m("",!0),s.value.visibility==1?(i(),d(M,{key:1,class:"top-tag",type:"error",size:"small",round:""},{default:n(()=>[y(" 私密 ")]),_:1})):m("",!0),s.value.visibility==2?(i(),d(M,{key:2,class:"top-tag",type:"info",size:"small",round:""},{default:n(()=>[y(" 好友可见 ")]),_:1})):m("",!0),r("div",null,[r("span",Ua,f(_(ta)(s.value.created_on))+" "+f(s.value.ip_loc),1)])]),"header-extra":n(()=>[r("div",Da,[o(P,{placement:"bottom-end",trigger:"click",size:"small",options:w.value,onSelect:t},{default:n(()=>[o(U,{quaternary:"",circle:""},{icon:n(()=>[o(_(O),null,{default:n(()=>[o(_(me))]),_:1})]),_:1})]),_:1},8,["options"])])]),footer:n(()=>[s.value.attachments.length>0?(i(),d(l,{key:0,attachments:s.value.attachments},null,8,["attachments"])):m("",!0),s.value.charge_attachments.length>0?(i(),d(l,{key:1,attachments:s.value.charge_attachments,price:s.value.attachment_price},null,8,["attachments","price"])):m("",!0),s.value.imgs.length>0?(i(),d(T,{key:2,imgs:s.value.imgs},null,8,["imgs"])):m("",!0),s.value.videos.length>0?(i(),d(D,{key:3,videos:s.value.videos},null,8,["videos"])):m("",!0),s.value.links.length>0?(i(),d(W,{key:4,links:s.value.links},null,8,["links"])):m("",!0)]),action:n(()=>[o(B,{justify:"space-between"},{default:n(()=>[r("div",Ba,[o(_(O),{size:"18",class:"opt-item-icon"},{default:n(()=>[o(_(oa))]),_:1}),y(" "+f(s.value.upvote_count),1)]),r("div",{class:"opt-item",onClick:u[3]||(u[3]=V(x=>C(s.value.id),["stop"]))},[o(_(O),{size:"18",class:"opt-item-icon"},{default:n(()=>[o(_(na))]),_:1}),y(" "+f(s.value.comment_count),1)]),r("div",ja,[o(_(O),{size:"18",class:"opt-item-icon"},{default:n(()=>[o(_(ua))]),_:1}),y(" "+f(s.value.collection_count),1)])]),_:1})]),_:2},[s.value.texts.length>0?{name:"description",fn:n(()=>[r("div",{onClick:u[2]||(u[2]=x=>C(s.value.id))},[(i(!0),h(le,null,oe(s.value.texts,x=>(i(),h("span",{key:x.id,class:"post-text",onClick:u[1]||(u[1]=V(g=>F(g,s.value.id),["stop"])),innerHTML:_(Re)(x.content).content},null,8,Wa))),128))])]),key:"0"}:void 0]),1024)])}}});const Ha={key:0,class:"profile-baseinfo"},Na={class:"avatar"},Va={class:"base-info"},Ra={class:"username"},Ea={class:"userinfo"},Ga={class:"info-item"},Qa={class:"info-item"},Ja={class:"userinfo"},Ka={class:"info-item"},Xa={class:"info-item"},Ya={key:0,class:"user-opts"},Za={key:0,class:"skeleton-wrap"},et={key:1},at={key:0,class:"empty-wrap"},tt={key:1},st={key:2},lt={class:"load-more-wrap"},ot={class:"load-more-spinner"},nt=_e({__name:"Me",setup(ne){const I=da(),k=pe(),$=aa(),p=c(!1),w=c(!1),t=Xe({id:0,avatar:"",username:"",nickname:"",is_admin:!1,is_friend:!0,is_following:!1,created_on:0,follows:0,followings:0,status:1}),s=c(!1),C=c(!1),F=c(!1),a=c([]),u=c([]),b=c([]),L=c([]),M=c([]),U=c([]),P=c($.query.s||""),l=c(+$.query.p||1),T=c("post"),D=c(+$.query.p||1),W=c(1),B=c(1),j=c(1),x=c(1),g=c(20),v=c(0),G=c(0),Q=c(0),J=c(0),K=c(0),X=c(0),we=()=>{w.value=!1,a.value=[],u.value=[],b.value=[],L.value=[],M.value=[],U.value=[],T.value="post",l.value=1,D.value=1,W.value=1,B.value=1,j.value=1,x.value=1,v.value=0,G.value=0,Q.value=0,J.value=0,K.value=0,X.value=0},ye=()=>{switch(T.value){case"post":R();break;case"comment":Y();break;case"highlight":Z();break;case"media":ee();break;case"star":ae();break}},R=()=>{p.value=!0,N({username:P.value,style:"post",page:l.value,page_size:g.value}).then(e=>{p.value=!1,e.list.length===0&&(w.value=!0),l.value>1?a.value=a.value.concat(e.list):(a.value=e.list||[],window.scrollTo(0,0)),v.value=Math.ceil(e.pager.total_rows/g.value),u.value=a.value,G.value=v.value}).catch(e=>{a.value=[],l.value>1&&l.value--,p.value=!1})},Y=()=>{p.value=!0,N({username:P.value,style:"comment",page:l.value,page_size:g.value}).then(e=>{p.value=!1,e.list.length===0&&(w.value=!0),l.value>1?a.value=a.value.concat(e.list):(a.value=e.list||[],window.scrollTo(0,0)),v.value=Math.ceil(e.pager.total_rows/g.value),b.value=a.value,Q.value=v.value}).catch(e=>{a.value=[],l.value>1&&l.value--,p.value=!1})},Z=()=>{p.value=!0,N({username:P.value,style:"highlight",page:l.value,page_size:g.value}).then(e=>{p.value=!1,e.list.length===0&&(w.value=!0),l.value>1?a.value=a.value.concat(e.list):(a.value=e.list||[],window.scrollTo(0,0)),v.value=Math.ceil(e.pager.total_rows/g.value),L.value=a.value,J.value=v.value}).catch(e=>{a.value=[],l.value>1&&l.value--,p.value=!1})},ee=()=>{p.value=!0,N({username:P.value,style:"media",page:l.value,page_size:g.value}).then(e=>{p.value=!1,e.list.length===0&&(w.value=!0),l.value>1?a.value=a.value.concat(e.list):(a.value=e.list||[],window.scrollTo(0,0)),v.value=Math.ceil(e.pager.total_rows/g.value),M.value=a.value,K.value=v.value}).catch(e=>{a.value=[],l.value>1&&l.value--,p.value=!1})},ae=()=>{p.value=!0,N({username:P.value,style:"star",page:l.value,page_size:g.value}).then(e=>{p.value=!1,e.list.length===0&&(w.value=!0),l.value>1?a.value=a.value.concat(e.list):(a.value=e.list||[],window.scrollTo(0,0)),v.value=Math.ceil(e.pager.total_rows/g.value),U.value=a.value,X.value=v.value}).catch(e=>{a.value=[],l.value>1&&l.value--,p.value=!1})},be=e=>{switch(T.value=e,T.value){case"post":a.value=u.value,l.value=D.value,v.value=G.value,R();break;case"comment":a.value=b.value,l.value=W.value,v.value=Q.value,Y();break;case"highlight":a.value=L.value,l.value=B.value,v.value=J.value,Z();break;case"media":a.value=M.value,l.value=j.value,v.value=K.value,ee();break;case"star":a.value=U.value,l.value=x.value,v.value=X.value,ae();break}},A=()=>{s.value=!0,xa({username:P.value}).then(e=>{s.value=!1,t.id=e.id,t.avatar=e.avatar,t.username=e.username,t.nickname=e.nickname,t.is_admin=e.is_admin,t.is_friend=e.is_friend,t.created_on=e.created_on,t.is_following=e.is_following,t.follows=e.follows,t.followings=e.followings,t.status=e.status,ye()}).catch(e=>{s.value=!1,console.log(e)})},Pe=()=>{switch(T.value){case"post":D.value=l.value,R();break;case"comment":W.value=l.value,Y();break;case"highlight":B.value=l.value,Z();break;case"media":j.value=l.value,ee();break;case"star":x.value=l.value,ae();break}},$e=()=>{C.value=!0},Te=()=>{F.value=!0},xe=()=>{C.value=!1},ze=()=>{F.value=!1},q=e=>()=>E(O,null,{default:()=>E(e)}),Ce=se(()=>{let e=[{label:"私信",key:"whisper",icon:q(ca)}];return k.state.userInfo.is_admin&&(t.status===1?e.push({label:"禁言",key:"banned",icon:q(re)}):e.push({label:"解封",key:"deblocking",icon:q(re)})),t.is_following?e.push({label:"取消关注",key:"unfollow",icon:q(ra)}):e.push({label:"关注",key:"follow",icon:q(_a)}),t.is_friend?e.push({label:"删除好友",key:"delete",icon:q(va)}):e.push({label:"添加朋友",key:"requesting",icon:q(pa)}),e}),Me=e=>{switch(e){case"whisper":$e();break;case"delete":qe();break;case"requesting":Te();break;case"follow":case"unfollow":Oe();break;case"banned":case"deblocking":Se();break}},qe=()=>{I.warning({title:"删除好友",content:"将好友 “"+t.nickname+"” 删除，将同时删除 点赞/收藏 列表中关于该朋友的 “好友可见” 推文",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{s.value=!0,za({user_id:t.id}).then(e=>{s.value=!1,t.is_friend=!1,R()}).catch(e=>{s.value=!1,console.log(e)})}})},Oe=()=>{I.success({title:"提示",content:"确定"+(t.is_following?"取消关注":"关注")+"该用户吗？",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{s.value=!0,t.is_following?Ca({user_id:t.id}).then(e=>{s.value=!1,window.$message.success("取消关注成功"),A()}).catch(e=>{s.value=!1,console.log(e)}):Ma({user_id:t.id}).then(e=>{s.value=!1,window.$message.success("关注成功"),A()}).catch(e=>{s.value=!1,console.log(e)})}})},Se=()=>{I.warning({title:"警告",content:"确定对该用户进行"+(t.status===1?"禁言":"解封")+"处理吗？",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{s.value=!0,qa({id:t.id,status:t.status===1?2:1}).then(e=>{s.value=!1,t.status===1?window.$message.success("禁言成功"):window.$message.success("解封成功"),A()}).catch(e=>{s.value=!1,console.log(e)})}})},Ie=()=>{l.value<v.value||v.value==0?(w.value=!1,l.value++,Pe()):w.value=!0};return Ye(()=>{A()}),Ze(()=>({path:$.path,query:$.query}),(e,z)=>{z.path==="/m"&&e.path==="/m"&&(P.value=$.query.s||"",we(),A())}),(e,z)=>{const Fe=de,te=fe,ue=ve("router-link"),Le=ge,Ue=he,De=Ta,ie=ga,H=ha,We=ka,Be=Pa,je=wa,Ae=ba,ce=ya,He=Aa,Ne=fa,Ve=ke;return i(),h("div",null,[o(Ne,{class:"main-content-wrap profile-wrap",bordered:""},{default:n(()=>[o(ie,{show:s.value},{default:n(()=>[t.id>0?(i(),h("div",Ha,[r("div",Na,[o(Fe,{size:72,src:t.avatar},null,8,["src"])]),r("div",Va,[r("div",Ra,[r("strong",null,f(t.nickname),1),r("span",null," @"+f(t.username),1),_(k).state.userInfo.id>0&&_(k).state.userInfo.username!=t.username&&t.is_friend?(i(),d(te,{key:0,class:"top-tag",type:"info",size:"small",round:""},{default:n(()=>[y(" 好友 ")]),_:1})):m("",!0),_(k).state.userInfo.id>0&&_(k).state.userInfo.username!=t.username&&t.is_following?(i(),d(te,{key:1,class:"top-tag",type:"success",size:"small",round:""},{default:n(()=>[y(" 已关注 ")]),_:1})):m("",!0),t.is_admin?(i(),d(te,{key:2,class:"top-tag",type:"error",size:"small",round:""},{default:n(()=>[y(" 管理员 ")]),_:1})):m("",!0)]),r("div",Ea,[r("span",Ga,"UID. "+f(t.id),1),r("span",Qa,f(_(sa)(t.created_on))+" 加入",1)]),r("div",Ja,[r("span",Ka,[o(ue,{onClick:z[0]||(z[0]=V(()=>{},["stop"])),class:"following-link",to:{name:"following",query:{s:t.username,n:t.nickname,t:"follows"}}},{default:n(()=>[y(" 关注  "+f(t.follows),1)]),_:1},8,["to"])]),r("span",Xa,[o(ue,{onClick:z[1]||(z[1]=V(()=>{},["stop"])),class:"following-link",to:{name:"following",query:{s:t.username,n:t.nickname,t:"followings"}}},{default:n(()=>[y(" 粉丝  "+f(t.followings),1)]),_:1},8,["to"])])])]),_(k).state.userInfo.id>0&&_(k).state.userInfo.username!=t.username?(i(),h("div",Ya,[o(Ue,{placement:"bottom-end",trigger:"click",size:"small",options:Ce.value,onSelect:Me},{default:n(()=>[o(Le,{quaternary:"",circle:""},{icon:n(()=>[o(_(O),null,{default:n(()=>[o(_(me))]),_:1})]),_:1})]),_:1},8,["options"])])):m("",!0)])):m("",!0),o(De,{show:C.value,user:t,onSuccess:xe},null,8,["show","user"]),o($a,{show:F.value,user:t,onSuccess:ze},null,8,["show","user"])]),_:1},8,["show"]),o(We,{class:"profile-tabs-wrap",type:"line",animated:"",value:T.value,"onUpdate:value":be},{default:n(()=>[o(H,{name:"post",tab:"泡泡"}),o(H,{name:"comment",tab:"评论"}),o(H,{name:"highlight",tab:"亮点"}),o(H,{name:"media",tab:"图文"}),o(H,{name:"star",tab:"喜欢"})]),_:1},8,["value"]),p.value&&a.value.length===0?(i(),h("div",Za,[o(Be,{num:g.value},null,8,["num"])])):(i(),h("div",et,[a.value.length===0?(i(),h("div",at,[o(je,{size:"large",description:"暂无数据"})])):m("",!0),_(k).state.desktopModelShow?(i(),h("div",tt,[(i(!0),h(le,null,oe(a.value,S=>(i(),d(ce,{key:S.id},{default:n(()=>[o(Ae,{post:S},null,8,["post"])]),_:2},1024))),128))])):(i(),h("div",st,[(i(!0),h(le,null,oe(a.value,S=>(i(),d(ce,{key:S.id},{default:n(()=>[o(He,{post:S},null,8,["post"])]),_:2},1024))),128))]))]))]),_:1}),v.value>0?(i(),d(Ve,{key:0,justify:"center"},{default:n(()=>[o(_(Sa),{class:"load-more",slots:{complete:"没有更多泡泡了",error:"加载出错"},onInfinite:z[2]||(z[2]=S=>Ie())},{spinner:n(()=>[r("div",lt,[w.value?m("",!0):(i(),d(ie,{key:0,size:14})),r("span",ot,f(w.value?"没有更多泡泡了":"加载更多"),1)])]),_:1})]),_:1})):m("",!0)])}}});const Bt=Oa(nt,[["__scopeId","data-v-14472e7a"]]);export{Bt as default};
