import{p as D,a as F,_ as I,b as A,c as E}from"./content-3263433b.js";import{d as Q,n as w,a4 as R,o,c as f,V as n,a8 as G,a2 as a,a as l,F as J,a5 as K,a3 as k,_ as i,e as c,M as p,Q as u,O as r,s as x}from"./@vue-7e1ab0af.js";import{u as U}from"./vuex-f1ee712f.js";import{u as W}from"./vue-router-edf90322.js";import{c as X}from"./formatTime-4210fcd1.js";import{c as Y}from"./copy-to-clipboard-4ef7d3eb.js";import{i as Z,j as ee,l as te,m as se,o as ae}from"./@vicons-b98681e0.js";import{j as m,o as ne,M as oe,e as ie,O as le,a as ue,L as re}from"./naive-ui-df120204.js";const ce={class:"post-item"},pe={class:"nickname-wrap"},_e={class:"username-wrap"},me={class:"timestamp-mobile"},de={class:"item-header-extra"},ve=["innerHTML"],he={class:"opt-item"},ge={class:"opt-item"},ze=Q({__name:"mobile-post-item",props:{post:{}},setup(b){const $=b,v=W(),C=U(),z=s=>()=>x(m,null,{default:()=>x(s)}),O=w(()=>[{label:"复制链接",key:"copyTweetLink",icon:z(ae)}]),T=async s=>{switch(s){case"copyTweetLink":Y(`${window.location.origin}/#/post?id=${e.value.id}`),window.$message.success("链接已复制到剪贴板");break}},e=w(()=>{let s=Object.assign({texts:[],imgs:[],videos:[],links:[],attachments:[],charge_attachments:[]},$.post);return s.contents.map(t=>{(+t.type==1||+t.type==2)&&s.texts.push(t),+t.type==3&&s.imgs.push(t),+t.type==4&&s.videos.push(t),+t.type==6&&s.links.push(t),+t.type==7&&s.attachments.push(t),+t.type==8&&s.charge_attachments.push(t)}),s}),h=s=>{v.push({name:"post",query:{id:s}})},q=(s,t)=>{if(s.target.dataset.detail){const _=s.target.dataset.detail.split(":");if(_.length===2){C.commit("refresh"),_[0]==="tag"?v.push({name:"home",query:{q:_[1],t:"tag"}}):v.push({name:"user",query:{s:_[1]}});return}}h(t)};return(s,t)=>{const _=ne,L=R("router-link"),g=oe,M=ie,S=le,y=F,B=I,N=A,V=E,j=ue,H=re;return o(),f("div",ce,[n(H,{"content-indented":""},G({avatar:a(()=>[n(_,{round:"",size:30,src:e.value.user.avatar},null,8,["src"])]),header:a(()=>[l("span",pe,[n(L,{onClick:t[0]||(t[0]=k(()=>{},["stop"])),class:"username-link",to:{name:"user",query:{s:e.value.user.username}}},{default:a(()=>[c(p(e.value.user.nickname),1)]),_:1},8,["to"])]),l("span",_e," @"+p(e.value.user.username),1),e.value.is_top?(o(),u(g,{key:0,class:"top-tag",type:"warning",size:"small",round:""},{default:a(()=>[c(" 置顶 ")]),_:1})):r("",!0),e.value.visibility==1?(o(),u(g,{key:1,class:"top-tag",type:"error",size:"small",round:""},{default:a(()=>[c(" 私密 ")]),_:1})):r("",!0),e.value.visibility==2?(o(),u(g,{key:2,class:"top-tag",type:"info",size:"small",round:""},{default:a(()=>[c(" 好友可见 ")]),_:1})):r("",!0),l("div",null,[l("span",me,p(i(X)(e.value.created_on))+" "+p(e.value.ip_loc),1)])]),"header-extra":a(()=>[l("div",de,[n(S,{placement:"bottom-end",trigger:"click",size:"small",options:O.value,onSelect:T},{default:a(()=>[n(M,{quaternary:"",circle:""},{icon:a(()=>[n(i(m),null,{default:a(()=>[n(i(Z))]),_:1})]),_:1})]),_:1},8,["options"])])]),footer:a(()=>[e.value.attachments.length>0?(o(),u(y,{key:0,attachments:e.value.attachments},null,8,["attachments"])):r("",!0),e.value.charge_attachments.length>0?(o(),u(y,{key:1,attachments:e.value.charge_attachments,price:e.value.attachment_price},null,8,["attachments","price"])):r("",!0),e.value.imgs.length>0?(o(),u(B,{key:2,imgs:e.value.imgs},null,8,["imgs"])):r("",!0),e.value.videos.length>0?(o(),u(N,{key:3,videos:e.value.videos},null,8,["videos"])):r("",!0),e.value.links.length>0?(o(),u(V,{key:4,links:e.value.links},null,8,["links"])):r("",!0)]),action:a(()=>[n(j,{justify:"space-between"},{default:a(()=>[l("div",he,[n(i(m),{size:"18",class:"opt-item-icon"},{default:a(()=>[n(i(ee))]),_:1}),c(" "+p(e.value.upvote_count),1)]),l("div",{class:"opt-item",onClick:t[3]||(t[3]=k(d=>h(e.value.id),["stop"]))},[n(i(m),{size:"18",class:"opt-item-icon"},{default:a(()=>[n(i(te))]),_:1}),c(" "+p(e.value.comment_count),1)]),l("div",ge,[n(i(m),{size:"18",class:"opt-item-icon"},{default:a(()=>[n(i(se))]),_:1}),c(" "+p(e.value.collection_count),1)])]),_:1})]),_:2},[e.value.texts.length>0?{name:"description",fn:a(()=>[l("div",{onClick:t[2]||(t[2]=d=>h(e.value.id))},[(o(!0),f(J,null,K(e.value.texts,d=>(o(),f("span",{key:d.id,class:"post-text",onClick:t[1]||(t[1]=k(P=>q(P,e.value.id),["stop"])),innerHTML:i(D)(d.content).content},null,8,ve))),128))])]),key:"0"}:void 0]),1024)])}}});export{ze as _};
